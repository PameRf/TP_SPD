TP2_Cerradura

tinkercad:
https://www.tinkercad.com/things/bxRBzV8kP87-tp2/editel?sharecode=478TcPuLGBM1PrzSwnnmEHeMlNt-cfyR2C2xo_f49a8

#include <stdio.h>
#include <string.h>
#include <Keypad.h>
#include <LiquidCrystal.h>


#define SIZE 4
#define LED_VERDE 9
#define LED_ROJO 10
#define DELAY 20

#define BOTON_TEST_PSW 11
#define BOTON_RESET 12
#define BOTON_CONFIG A4

int compararClaveIngresada(char clave[], char digito[], int len);
LiquidCrystal monitor(8,13,A0,A1,A2,A3);



const byte FILAS= SIZE;
const byte COLUMNAS=SIZE;
char caracteres[SIZE][SIZE]={
  {'1','2','3','A'},
  {'4','5','6','B'},
  {'7','8','9','C'},
  {'*','0','#','D'},
};
				
byte pinesFilas[SIZE]={7,6,5,4};
				
byte pinesColumnas[SIZE]={3,2,1,0};
				
Keypad miTeclado= Keypad (makeKeymap(caracteres), 
                 pinesFilas, pinesColumnas, FILAS, COLUMNAS);
void setup()
{
  monitor.begin(16,2);
  pinMode(LED_VERDE,OUTPUT);
  pinMode(LED_ROJO,OUTPUT);
  
  pinMode(BOTON_RESET, INPUT);
  pinMode(BOTON_TEST_PSW, INPUT);
  pinMode(BOTON_CONFIG, INPUT);
  
  monitor.setCursor(0,0);
  
  monitor.print("Password: ");
   
}
char clave[7]={'2','C','2','0','2','2','\0'};

int posicion=0; 
char digitos[7];
int tiempo_leds;
int led_time;
int botonResetAntes=0;
int botonTestAntes=0;
int botonConfigAntes=0;
int flag=0;

void loop()
{
  int segundos=millis()/1000;
  
  int botonResetAhora = digitalRead(BOTON_RESET);
  int botonTestAhora= digitalRead(BOTON_TEST_PSW);
  int botonConfigAhora= digitalRead(BOTON_CONFIG);
 
  char boton= miTeclado.getKey();
     
  
    if(boton != NO_KEY){
         
        monitor.setCursor(posicion,1);
        monitor.print(boton);
       	digitos[posicion]=boton;
        posicion++;     
     
        
      }
if(posicion >=6 || botonTestAhora == 1){
    
   botonTestAhora= 0;
    
    if (strcmp(digitos,clave)==0){
      monitor.setCursor(0,0);
      monitor.print("Password OK");
      digitalWrite(LED_VERDE,HIGH); 
      if(segundos - tiempo_leds >= DELAY){
      	
        digitalWrite(LED_VERDE,LOW);
      
      }
    }
    if (strcmp(digitos,clave)!=0){
      
      monitor.setCursor(0,0);
      monitor.print("Password FAIL");
      digitalWrite(LED_ROJO,HIGH);
      
       if(segundos - tiempo_leds >= DELAY){
      
         digitalWrite(LED_ROJO,LOW);    
          
      }
        
    }
    
   botonTestAntes=botonTestAhora;
   botonResetAntes= botonResetAhora;
   botonConfigAntes= botonConfigAhora;
     
  }
    
 
   delay(25);    
}
  
 